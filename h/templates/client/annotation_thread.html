<a href=""
   class="threadexp"
   title="{{vm.thread.collapsed && 'Expand' || 'Collapse'}}"
   ng-click="vm.toggleCollapsed()"
   ng-if="vm.thread.parent">
   <span ng-class="{'h-icon-arrow-right': vm.thread.collapsed,
                    'h-icon-arrow-drop-down': !vm.thread.collapsed}"></span>
</a>

<!-- Annotation -->
<annotation class="annotation thread-message {{vm.thread.collapsed && 'collapsed'}}"
         annotation="vm.thread.annotation"
         is-last-reply="$last"
         is-sidebar="::vm.isSidebar"
         name="annotation"
         ng-if="vm.thread.annotation"
         ng-show="vm.thread.visible"
         show-document-info="vm.showDocumentInfo"
         on-reply-count-click="vm.toggleCollapsed()"
         on-editing-changed="vm.onEditingChanged(vm.thread.id,editing)"
         reply-count="vm.thread.replyCount">
</annotation>

<div ng-if="!vm.thread.annotation" class="thread-deleted">
  <p><em>Message not available.</em></p>
</div>

<div class="thread-load-more" ng-if="vm.hiddenCount() > 0">
  <a class="load-more small"
     href=""
     ng-click="vm.showThreadAndReplies()"
     ng-pluralize
     count="vm.hiddenCount()"
     when="{'0': '',
           one: 'View one more in conversation',
           other: 'View {} more in conversation'}"
     ></a>
</div>

<!-- Replies -->
<ul class="thread-replies" ng-show="!vm.thread.collapsed">
  <li class="thread" ng-repeat="child in vm.thread.children track by child.id">
    <annotation-thread
      show-document-info="false"
      thread="child"
      on-toggle-replies="vm.onToggleReplies({id:id})"
      on-force-visible="vm.onForceVisible({thread:thread})">
    </annotation-thread>
  </li>
</ul>
