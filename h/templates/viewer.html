<!-- View Sort Controls -->
<div class="viewsort">
  <div class="dropdown">
    <span role="button"
          class="dropdown-toggle"
          data-toggle="dropdown"
          >{{view}}</span>
    <ul class="dropdown-menu"
        role="menu">
      <li ng-repeat="view in views">
        <a href="" ng-click="applyView(view.view)">{{view.view}}</a>
      </li>
    </ul>
  </div>

  <div class="dropdown">
    <span role="button"
          class="dropdown-toggle"
          data-toggle="dropdown"
          >{{sort}}</span>
    <ul class="dropdown-menu"
        role="menu">
      <li ng-repeat="sort in sorts">
        <a href="" ng-click="applySort(sort.sort)">{{sort.sort}}</a>
      </li>
    </ul>
  </div>
</div>
<!-- / View Sort Controls -->

<!-- Thread view -->
<ul class="stream-list">
  <li
     ng-class="{'card-emphasis': annotation.$emphasis, 'collapsed': collapsed}"
     ng-click="toggleCollapsed($event)"
     ng-init="collapsed = true"
     ng-mouseenter="focus(annotation)"
     ng-mouseleave="focus()"
     ng-repeat="annotation in annotations | orderBy:predicate:reverse track by annotation.id"
     class="paper thread"
     data-recursive=""
     >
    <a href="" class="threadexp"
       title="{{collapsed && 'Expand' || 'Collapse'}}"
       ng-show="$parent.annotation"
       />

    <!-- Excerpts -->
    <div class="excerpt"
         ng-repeat="target in annotation.target"
         ng-hide="collapsed">
      <blockquote ng-bind="target.quote" ng-hide="target.showDiff" />
      <blockquote ng-bind-html="target.trustedDiffHTML" ng-show="target.showDiff" />
      <div class="small pull-right" ng-show="target.diffHTML">
        <input type="checkbox" ng-model="target.showDiff" ng-click="$event.stopPropagation()"> Show differences</input>
      </div>
    </div>

    <!-- Annotation -->
    <div class="annotation"
         name="annotation"
         ng-model="annotation" />

    <!-- Replies -->
    <ul>
      <li class="thread"
          ng-class="{'collapsed': collapsed}"
          ng-click="toggleCollapsed($event)"
          ng-repeat="annotation in annotation.reply_list"
          ng-transclude
          />
    </ul>
  </li>
</ul>
