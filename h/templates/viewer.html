<ul class="sliding-panels">
  <li>
    <ul>
      <li ng-mouseenter="focus(thread.message)"
          ng-mouseleave="focus()"
          ng-repeat="thread in threads track by thread.message.id"
          class="stream-list"
          ng-class="thread.message.$emphasis && 'card-emphasis'"
      >

        <!-- Thread view -->
        <div class="paper thread"
             data-recursive=""
             ng-class="collapsed && 'collapsed summary' || ''"
             ng-mousedown="toggleCollapsedDown($event)"
             ng-click="toggleCollapsed($event)"
             ng-init="collapsed = true"
             >
          <a href="" class="threadexp"
             title="{{collapsed && 'Expand' || 'Collapse'}}"
             ng-show="$parent.thread.message"
             />

          <!-- Excerpts -->
          <div class="excerpt"
               ng-repeat="target in thread.message.target"
               ng-hide="collapsed">
            <blockquote ng-bind="target.quote" ng-hide="target.showDiff" />
            <blockquote ng-bind-html="target.trustedDiffHTML" ng-show="target.showDiff" />
            <div class="small pull-right" ng-show="target.diffHTML">
              <input type="checkbox" ng-model="target.showDiff" ng-click="$event.stopPropagation()"> Show differences</input>
            </div>
          </div>

          <!-- Annotation -->
          <div class="annotation"
               name="annotation"
               ng-model="$parent.thread.message" />

          <!-- Replies -->
          <ul>
            <li class="thread"
                ng-class="collapsed && 'collapsedreplies' || ''"
                ng-click="toggleCollapsed($event)"
                ng-repeat="thread in thread.children"
                ng-transclude
                />
          </ul>
        </div>
      </li>
    </ul>
  </li>
</ul>
